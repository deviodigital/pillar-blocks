#!/usr/bin/env node

require.paths.unshift(__dirname + '/../dep');

var fs = require('fs');
var underscore = require('underscore');
var strings = require('underscore.strings');

var m1test = require('../lib/m1test');
var argParser = require('../dep/nomnom');

var options = argParser.parseArgs();

var getDefaultFiles = function() {
    var root = process.cwd() + '/test';
    var dirList = fs.readdirSync(root);
    var files = [];
    _(dirList).each(function(file) {
        if (_.contains(file, 'test') && _.endsWith(file, '.js')) {
            files.push(root + '/' + file);
        }
    });
    return files;
};

var getTestFiles = function(options) {
    var files = [];
    var root = process.cwd();
    _(options).each(function(file) {
        files.push(root + '/' + file);
    });
    if (files.length <= 0) {
        files = getDefaultFiles();
    }
    return files;
};

var files = getTestFiles(options);
var runner = new TestRunner(files);
